#ifndef _INSTRUCTION_H_
#define _INSTRUCTION_H_

#include <string>
#include <iostream>


//////////////////////////////////////////////////////////////////////////////////////////
/// @brief Instruction class
//////////////////////////////////////////////////////////////////////////////////////////
class Instruction {
  private:
    std::string binStr;                 ///< binary string of instruction
    std::string opcode;                 ///< stores the opcode of the instruction
    int rs = -1;                        ///< stores the rs register
    int rt = -1;                        ///< stores the rt register
    int rd = -1;                        ///< stores the rd register
    std::string imm;                    ///< stores the immediate field
    std::string func;                   ///< stores the function code of r-type instructions

    //////////////////////////////////////////////////////////////////////////////////////
    /// @brief parses the register number from a string starting with $
    /// @param r string of format $xx or $x
    int parseRegisterNumber(std::string r);

    //////////////////////////////////////////////////////////////////////////////////////
    /// @brief get offset value from string
    /// @param o string to get offset from
    int parseOffset(std::string o);

  public:
    //////////////////////////////////////////////////////////////////////////////////////
    /// @brief Instruction constructor
    /// @details This function should take a string of MIPS assembly, parse it into relevant
    /// parts and create the instruction object to be added to the InstructionData hashmap 
    //////////////////////////////////////////////////////////////////////////////////////
    Instruction() {}

    //////////////////////////////////////////////////////////////////////////////////////
    /// @brief Deleted Copy Constructor
    //////////////////////////////////////////////////////////////////////////////////////
    Instruction(const Instruction& other) = delete;

    //////////////////////////////////////////////////////////////////////////////////////
    /// @brief Destructor
    //////////////////////////////////////////////////////////////////////////////////////
    ~Instruction() {}

    //////////////////////////////////////////////////////////////////////////////////////
    /// @brief parses instruction string from input file
    /// @param inst input string to be parsed
    //////////////////////////////////////////////////////////////////////////////////////
    void parseInstruction(std::string inst);

    //////////////////////////////////////////////////////////////////////////////////////
    /// @brief << operator overload for output
    //////////////////////////////////////////////////////////////////////////////////////
    const std::ostream& operator<<(std::ostream& os);

    //////////////////////////////////////////////////////////////////////////////////////
    /// @brief gets the opcode of the function
    std::string getOpcode() const { return opcode; }

    //////////////////////////////////////////////////////////////////////////////////////
    /// @brief gets the opcode of the function
    std::string getFuncField() const { return func; }
    
    //////////////////////////////////////////////////////////////////////////////////////
    /// @brief tests the Instruction class
    //////////////////////////////////////////////////////////////////////////////////////
    void testInstruction() { }

};

#endif
